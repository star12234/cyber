import joblib
import pandas as pd
import urllib.parse
import re
import time
#import whois
from datetime import datetime
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
"""
#도메인 나이 확인
#def check_domain_age(domain):
    try:
        time.sleep(0.3)
        w = whois.whois(domain)
        creation_date = w.creation_date
        if isinstance(creation_date, list):
            creation_date = creation_date[0]
        if creation_date:
            return (datetime.now() - creation_date).days
        else:
            return -1  # creation_date가 None일 경우
    except Exception as e:
        print(f"[WHOIS 오류] 도메인 '{domain}' 조회 실패:", e)
 #       return -1
 """
# URL 특징 추출 함수
def extract_features(url):
    parsed_url = urllib.parse.urlparse(url)
    domain = parsed_url.netloc.replace("www.", "")
    features = {
        'url_length': len(url),
        'num_digits': sum(c.isdigit() for c in url),
        'num_special_chars': len(re.findall(r'[^a-zA-Z0-9]', url)),
        'has_https': 1 if parsed_url.scheme == 'https' else 0,
        'num_subdomains': len(parsed_url.netloc.split('.')) - 2,
        'num_params': len(parsed_url.query.split('&')) if parsed_url.query else 0,
    }
    return features

# 수동 입력된 URL (정상 + 악성)
normal_urls = [
  "http://google.com"    ,
  "http://microsoft.com"    ,
  "http://mail.ru"    ,
  "http://facebook.com"    ,
  "http://dzen.ru"    ,
  "http://root-servers.net"    ,
  "http://amazonaws.com"    ,
  "http://apple.com"    ,
  "http://youtube.com"    ,
  "http://googleapis.com"    ,
  "http://cloudflare.com"    ,
  "http://akamai.net"    ,
  "http://instagram.com"    ,
  "http://twitter.com"    ,
  "http://akamaiedge.net"    ,
  "http://a-msedge.net"    ,
  "http://office.com"    ,
  "http://gstatic.com"    ,
  "http://azure.com"    ,
  "http://linkedin.com"    ,
  "http://speedcdns.com"    ,
  "http://live.com"    ,
  "http://googletagmanager.com"    ,
  "http://googlevideo.com"    ,
  "http://amazon.com"    ,
  "http://fbcdn.net"    ,
  "http://akadns.net"    ,
  "http://workers.dev"    ,
  "http://wikipedia.org"    ,
  "http://microsoftonline.com"    ,
  "http://tiktokcdn.com"    ,
  "http://doubleclick.net"    ,
  "http://windowsupdate.com"    ,
  "http://googleusercontent.com"    ,
  "http://github.com"    ,
  "http://l-msedge.net"    ,
  "http://t-msedge.net"    ,
  "http://trafficmanager.net"    ,
  "http://bing.com"    ,
  "http://office.net"    ,
  "http://apple-dns.net"    ,
  "http://dual-s-msedge.net"    ,
  "http://wordpress.org"    ,
  "http://fastly.net"    ,
  "http://pinterest.com"    ,
  "http://icloud.com"    ,
  "http://whatsapp.net"    ,
  "http://youtu.be"    ,
  "http://aaplimg.com"    ,
  "http://netflix.com"    ,
  "http://sharepoint.com"    ,
  "http://appsflyersdk.com"    ,
  "http://digicert.com"    ,
  "http://domaincontrol.com"    ,
  "http://yahoo.com"    ,
  "http://ax-msedge.net"    ,
  "http://skype.com"    ,
  "http://googlesyndication.com"    ,
  "http://goo.gl"    ,
  "http://gtld-servers.net"    ,
  "http://whatsapp.com"    ,
  "http://cloudfront.net"    ,
  "http://adobe.com"    ,
  "http://vimeo.com"    ,
  "http://windows.net"    ,
  "http://spotify.com"    ,
  "http://msn.com"    ,
  "http://tiktokv.com"    ,
  "http://google-analytics.com"    ,
  "http://gvt2.com"    ,
  "http://bit.ly"    ,
  "http://roblox.com"    ,
  "http://ntp.org"    ,
  "http://bytefcdn-oversea.com"    ,
  "http://gvt1.com"    ,
  "http://cloudflare.net"    ,
  "http://cdn77.org"    ,
  "http://intuit.com"    ,
  "http://wordpress.com"    ,
  "http://tiktok.com"    ,
  "http://x.com"    ,
  "http://cdn90.cn"    ,
  "http://zoom.us"    ,
  "http://wac-msedge.net"    ,
  "http://yandex.net"    ,
  "http://nic.ru"    ,
  "http://ytimg.com"    ,
  "http://mozilla.org"    ,
  "http://gandi.net"    ,
  "http://qq.com"    ,
  "http://edgekey.net"    ,
  "http://office365.com"    ,
  "http://e2ro.com"    ,
  "http://blogspot.com"    ,
  "http://opera.com"    ,
  "http://telekom.de"    ,
  "http://googledomains.com"    ,
  "http://googleadservices.com"    ,
  "http://cloudflare-dns.com"    ,
  "http://reddit.com"    ,
  "http://samsung.com"    ,
  "http://cdninstagram.com"    ,
  "http://cdn20.com"    ,
  "http://msedge.net"    ,
  "http://aiv-cdn.net"    ,
  "http://unity3d.com"    ,
  "http://mts.ru"    ,
  "http://flickr.com"    ,
  "http://baidu.com"    ,
  "http://a2z.com"    ,
  "http://snapchat.com"    ,
  "http://europa.eu"    ,
  "http://telekom.net"    ,
  "http://nginx.org"    ,
  "http://outlook.com"    ,
  "http://tiktokrow-cdn.com"    ,
  "http://amazon-adsystem.com"    ,
  "http://sentry.io"    ,
  "http://apache.org"    ,
  "http://vk.com"    ,
  "http://t.me"    ,
  "http://wa.me"    ,
  "http://rbxcdn.com"    ,
  "http://adnxs.com"    ,
  "http://health.mil"    ,
  "http://nginx.com"    ,
  "http://rocket-cdn.com"    ,
  "http://dropbox.com"    ,
  "http://gravatar.com"    ,
  "http://app-analytics-services.com"    ,
  "http://nist.gov"    ,
  "http://windows.com"    ,
  "http://github.io"    ,
  "http://nih.gov"    ,
  "http://criteo.com"    ,
  "http://t-online.de"    ,
  "http://spo-msedge.net"    ,
  "http://pki.goog"    ,
  "http://epicgames.com"    ,
  "http://app-measurement.com"    ,
  "http://msftncsi.com"    ,
  "http://edgesuite.net"    ,
  "http://tumblr.com"    ,
  "http://userapi.com"    ,
  "http://okcdn.ru"    ,
  "http://dns.google"    ,
  "http://trbcdn.net"    ,
  "http://macromedia.com"    ,
  "http://ui.com"    ,
  "http://xiaomi.com"    ,
  "http://myfritz.net"    ,
  "http://nytimes.com"    ,
  "http://applovin.com"    ,
  "http://paypal.com"    ,
  "http://one.one"    ,
  "http://archive.org"    ,
  "http://ivi.ru"    ,
  "http://lencr.org"    ,
  "http://forms.gle"    ,
  "http://wsdvs.com"    ,
  "http://f5.com"    ,
  "http://ggpht.com"    ,
  "http://dnsowl.com"    ,
  "http://aliyuncs.com"    ,
  "http://steamserver.net"    ,
  "http://meraki.com"    ,
  "http://adriver.ru"    ,
  "http://mangosip.ru"    ,
  "http://medium.com"    ,
  "http://b-msedge.net"    ,
  "http://cnn.com"    ,
  "http://nflxso.net"    ,
  "http://forbes.com"    ,
  "http://tiktokcdn-us.com"    ,
  "http://whecloud.com"    ,
  "http://miit.gov.cn"    ,
  "http://soundcloud.com"    ,
  "http://t.co"    ,
  "http://wildberries.ru"    ,
  "http://rubiconproject.com"    ,
  "http://cdn-apple.com"    ,
  "http://discord.gg"    ,
  "http://w3.org"    ,
  "http://theguardian.com"    ,
  "http://registrar-servers.com"    ,
  "http://azurewebsites.net"    ,
  "http://casalemedia.com"    ,
  "http://yandex.ru"    ,
  "http://shifen.com"    ,
  "http://amazon.dev"    ,
  "http://adobe.io"    ,
  "http://kaspersky.com"    ,
  "http://s-msedge.net"    ,
  "http://amazonvideo.com"    ,
  "http://sciencedirect.com"    ,
  "http://miui.com"    ,
  "http://linkos.bg"    ,
  "http://gmail.com"    ,
  "http://android.com"    ,
  "http://demdex.net"    ,
  "http://ebay.com"    ,
  "http://akamaihd.net"    ,
  "http://akamaized.net"    ,
  "http://doubleverify.com"    ,
  "http://ozon.ru"    ,
  "http://twitch.tv"    ,
  "http://bbc.com"    ,
  "http://bbc.co.uk"    ,
  "http://ttlivecdn.com"    ,
  "http://b-cdn.net"    ,
  "http://taboola.com"    ,
  "http://creativecommons.org"    ,
  "http://roku.com"    ,
  "http://webex.com"    ,
  "http://jomodns.com"    ,
  "http://cisco.com"    ,
  "http://sourceforge.net"    ,
  "http://cedexis.net"    ,
  "http://edgecdn.ru"    ,
  "http://xn--8win4-xg1h.com"    ,
  "http://mit.edu"    ,
  "http://omtrdc.net"    ,
  "http://msftconnecttest.com"    ,
  "http://salesforce.com"    ,
  "http://3gppnetwork.org"    ,
  "http://ksyuncdn.com"    ,
  "http://qlivecdn.com"    ,
  "http://scorecardresearch.com"    ,
  "http://comcast.net"    ,
  "http://example.com"    ,
  "http://imdb.com"    ,
  "http://vungle.com"    ,
  "http://researchgate.net"    ,
  "http://ubuntu.com"    ,
  "http://shopify.com"    ,
  "http://cdngslb.com"    ,
  "http://arubanetworks.com"    ,
  "http://who.int"    ,
  "http://my.com"    ,
  "http://canva.com"    ,
  "http://nvidia.com"    ,
  "http://youtube-nocookie.com"    ,
  "http://openai.com"    ,
  "http://azurefd.net"    ,
  "http://pubmatic.com"    ,
  "http://hp.com"    ,
  "http://hubspot.com"    ,
  "http://doi.org"    ,
  "http://discord.com"    ,
  "http://slack.com"    ,
  "http://linktr.ee"    ,
  "http://oracle.com"    ,
  "http://avast.com"    ,
  "http://wixsite.com"    ,
  "http://dell.com"    ,
  "http://googleblog.com"    ,
  "http://facebook.net"    ,
  "http://nr-data.net"    ,
  "http://tinyurl.com"    ,
  "http://issuu.com"    ,
  "http://vedcdnlb.com"    ,
  "http://wikimedia.org"    ,
  "http://bytefcdn-ttpeu.com"    ,
  "http://ttdns2.com"    ,
  "http://byteoversea.net"    ,
  "http://openx.net"    ,
  "http://launchdarkly.com"    ,
  "http://mi.com"    ,
  "http://2mdn.net"    ,
  "http://pv-cdn.net"    ,
  "http://ampproject.org"    ,
  "http://appsflyer.com"    ,
  "http://crashlytics.com"    ,
  "http://taobao.com"    ,
  "http://stripe.com"    ,
  "http://netangels.ru"    ,
  "http://cpanel.net"    ,
  "http://tradingview.com"    ,
  "http://opendns.com"    ,
  "http://alibabadns.com"    ,
  "http://weebly.com"    ,
  "http://mzstatic.com"    ,
  "http://cdc.gov"    ,
  "http://drom.ru"    ,
  "http://mtgglobals.com"    ,
  "http://reuters.com"    ,
  "http://reg.ru"    ,
  "http://chatgpt.com"    ,
  "http://harvard.edu"    ,
  "http://3lift.com"    ,
  "http://php.net"    ,
  "http://samsungcloud.com"    ,
  "http://ln-msedge.net"    ,
  "http://godaddy.com"    ,
  "http://google.com.br"    ,
  "http://tiktokv.us"    ,
  "http://www.gov.uk"    ,
  "http://adsrvr.org"    ,
  "http://ripn.net"    ,
  "http://steampowered.com"    ,
  "http://espn.com"    ,
  "http://booking.com"    ,
  "http://launchpad.net"    ,
  "http://dailymail.co.uk"    ,
  "http://ibm.com"    ,
  "http://amazon.co.uk"    ,
  "http://azureedge.net"    ,
  "http://washingtonpost.com"    ,
  "http://static.microsoft"    ,
  "http://samsungqbe.com"    ,
  "http://wiley.com"    ,
  "http://slideshare.net"    ,
  "http://1c.ru"    ,
  "http://forter.com"    ,
  "http://appcenter.ms"    ,
  "http://xcal.tv"    ,
  "http://ttvnw.net"    ,
  "http://bidswitch.net"    ,
  "http://capcutapi.com"    ,
  "http://playstation.net"    ,
  "http://sharethrough.com"    ,
  "http://go.com"    ,
  "http://salesforceliveagent.com"    ,
  "http://weather.com"    ,
  "http://wsj.com"    ,
  "http://alicdn.com"    ,
  "http://alibaba.com"    ,
  "http://t-mobile.com"    ,
  "http://ea.com"    ,
  "http://inmobi.com"    ,
  "http://jsdelivr.net"    ,
  "http://spov-msedge.net"    ,
  "http://nature.com"    ,
  "http://branch.io"    ,
  "http://netflix.net"    ,
  "http://smartadserver.com"    ,
  "http://pages.dev"    ,
  "http://nease.net"    ,
  "http://outbrain.com"    ,
  "http://bloomberg.com"    ,
  "http://debian.org"    ,
  "http://shalltry.com"    ,
  "http://adtrafficquality.google"    ,
  "http://etsy.com"    ,
  "http://weibo.com"    ,
  "http://springer.com"    ,
  "http://fastly-edge.com"    ,
  "http://dailymotion.com"    ,
  "http://adsafeprotected.com"    ,
  "http://checkpoint.com"    ,
  "http://stackoverflow.com"    ,
  "http://un.org"    ,
  "http://worldfcdn2.com"    ,
  "http://mangatoon.mobi"    ,
  "http://allawnos.com"    ,
  "http://samsungcloudsolution.com"    ,
  "http://gnu.org"    ,
  "http://vkuser.net"    ,
  "http://mcafee.com"    ,
  "http://wp.com"    ,
  "http://deepintent.com"    ,
  "http://douyincdn.com"    ,
  "http://moe.video"    ,
  "http://google.de"    ,
  "http://gosuslugi.ru"    ,
  "http://zendesk.com"    ,
  "http://telegraph.co.uk"    ,
  "http://nasa.gov"    ,
  "http://liadm.com"    ,
  "http://rutube.ru"    ,
  "http://ring.com"    ,
  "http://goskope.com"    ,
  "http://huawei.com"    ,
  "http://mynetname.net"    ,
  "http://businessinsider.com"    ,
  "http://clarity.ms"    ,
  "http://cloud.microsoft"    ,
  "http://stanford.edu"    ,
  "http://independent.co.uk"    ,
  "http://pixabay.com"    ,
  "http://duckdns.org"    ,
  "http://list-manage.com"    ,
  "http://dnsmadeeasy.com"    ,
  "http://sc-cdn.net"    ,
  "http://pangle.io"    ,
  "http://inner-active.mobi"    ,
  "http://yximgs.com"    ,
  "http://heytapdl.com"    ,
  "http://hichina.com"    ,
  "http://kaspersky-labs.com"    ,
  "http://unsplash.com"    ,
  "http://crpt.ru"    ,
  "http://naver.com"    ,
  "http://gcdn.co"    ,
  "http://cnbc.com"    ,
  "http://notamedia.ru"    ,
  "http://foxnews.com"    ,
  "http://atomile.com"    ,
  "http://force.com"    ,
  "http://consultant.ru"    ,
  "http://wbx2.com"    ,
  "http://indeed.com"    ,
  "http://autodesk.com"    ,
  "http://quora.com"    ,
  "http://indexww.com"    ,
  "http://online-metrix.net"    ,
  "http://aliexpress.com"    ,
  "http://sohu.com"    ,
  "http://xboxlive.com"    ,
  "http://tp-link.com"    ,
  "http://ibyteimg.com"    ,
  "http://globo.com"    ,
  "http://googletagservices.com"    ,
  "http://google.co.uk"    ,
  "http://eventbrite.com"    ,
  "http://statista.com"    ,
  "http://bilibili.com"    ,
  "http://ok.ru"    ,
  "http://heytapmobile.com"    ,
  "http://temu.com"    ,
  "http://npr.org"    ,
  "http://aol.com"    ,
  "http://tiktokcdn-eu.com"    ,
  "http://intel.com"    ,
  "http://rambler.ru"    ,
  "http://ngenix.net"    ,
  "http://duckduckgo.com"    ,
  "http://nstld.com"    ,
  "http://goodreads.com"    ,
  "http://elasticbeanstalk.com"    ,
  "http://eset.com"    ,
  "http://amazon.de"    ,
  "http://dnspod.net"    ,
  "http://telegram.org"    ,
  "http://walmart.com"    ,
  "http://byteoversea.com"    ,
  "http://sfx.ms"    ,
  "http://xhamster.com"    ,
  "http://imgsmail.ru"    ,
  "http://giphy.com"    ,
  "http://cmediahub.ru"    ,
  "http://yahoo.co.jp"    ,
  "http://media-amazon.com"    ,
  "http://avcdn.net"    ,
  "http://mikrotik.com"    ,
  "http://ctdns.cn"    ,
  "http://ys7.com"    ,
  "http://wired.com"    ,
  "http://teamviewer.com"    ,
  "http://myshopify.com"    ,
  "http://kwai-pro.com"    ,
  "http://duolingo.com"    ,
  "http://mozilla.com"    ,
  "http://vtwenty.com"    ,
  "http://gamepass.com"    ,
  "http://usatoday.com"    ,
  "http://time.com"    ,
  "http://g.page"    ,
  "http://firetvcaptiveportal.com"    ,
  "http://telegram.me"    ,
  "http://behance.net"    ,
  "http://dns-parking.com"    ,
  "http://calendly.com"    ,
  "http://addtoany.com"    ,
  "http://mega.co.nz"    ,
  "http://netease.com"    ,
  "http://braze.com"    ,
  "http://nflximg.com"    ,
  "http://speedtest.net"    ,
  "http://id5-sync.com"    ,
  "http://grammarly.com"    ,
  "http://beian.gov.cn"    ,
  "http://scribd.com"    ,
  "http://safebrowsing.apple"    ,
  "http://sophos.com"    ,
  "http://amazonalexa.com"    ,
  "http://timeweb.ru"    ,
  "http://sc-gw.com"    ,
  "http://mayoclinic.org"    ,
  "http://wsglb0.com"    ,
  "http://mediatek.com"    ,
  "http://amzn.to"    ,
  "http://hicloud.com"    ,
  "http://ft.com"    ,
  "http://twimg.com"    ,
  "http://indiatimes.com"    ,
  "http://nest.com"    ,
  "http://imcmdb.net"    ,
  "http://kwai.net"    ,
  "http://nflxvideo.net"    ,
  "http://gitlab.com"    ,
  "http://entrust.net"    ,
  "http://avsxappcaptiveportal.com"    ,
  "http://paloaltonetworks.com"    ,
  "http://mysql.com"    ,
  "http://wix.com"    ,
  "http://blogger.com"    ,
  "http://cnet.com"    ,
  "http://uol.com.br"    ,
  "http://aliyun.com"    ,
  "http://awswaf.com"    ,
  "http://ietf.org"    ,
  "http://okta.com"    ,
  "http://surveymonkey.com"    ,
  "http://360yield.com"    ,
  "http://shein.com"    ,
  "http://squarespace.com"    ,
  "http://rlcdn.com"    ,
  "http://marriott.com"    ,
  "http://nypost.com"    ,
  "http://ovscdns.com"    ,
  "http://deviantart.com"    ,
  "http://trendmicro.com"    ,
  "http://yandex.com"    ,
  "http://adobe.net"    ,
  "http://verisign.com"    ,
  "http://media.net"    ,
  "http://comcast.com"    ,
  "http://impervadns.net"    ,
  "http://cdnbuild.net"    ,
  "http://name-services.com"    ,
  "http://tencent-cloud.net"    ,
  "http://plesk.com"    ,
  "http://disqus.com"    ,
  "http://ted.com"    ,
  "http://imgur.com"    ,
  "http://google.ca"    ,
  "http://berkeley.edu"    ,
  "http://vkontakte.ru"    ,
  "http://steamcommunity.com"    ,
  "http://ups.com"    ,
  "http://microsoftapp.net"    ,
  "http://patreon.com"    ,
  "http://virtualearth.net"    ,
  "http://sentinelone.net"    ,
  "http://spaceweb.pro"    ,
  "http://nestlabs.com"    ,
  "http://rakuten.co.jp"    ,
  "http://ca.gov"    ,
  "http://rzone.de"    ,
  "http://target.com"    ,
  "http://google.fr"    ,
  "http://onetrust.com"    ,
  "http://hotjar.com"    ,
  "http://redislabs.com"    ,
  "http://binance.com"    ,
  "http://visualstudio.com"    ,
  "http://buzzfeed.com"    ,
  "http://loc.gov"    ,
  "http://mtu.ru"    ,
  "http://msidentity.com"    ,
  "http://fast.com"    ,
  "http://jquery.com"    ,
  "http://icloud-content.com"    ,
  "http://line.me"    ,
  "http://oup.com"    ,
  "http://datadoghq.com"    ,
  "http://tripadvisor.com"    ,
  "http://britannica.com"    ,
  "http://rackspace.net"    ,
  "http://googlezip.net"    ,
  "http://yahoodns.net"    ,
  "http://deepl.com"    ,
  "http://amazon.co.jp"    ,
  "http://cornell.edu"    ,
  "http://playstation.com"    ,
  "http://myhuaweicloud.com"    ,
  "http://mailchimp.com"    ,
  "http://ipv4only.arpa"    ,
  "http://amazontrust.com"    ,
  "http://amplitude.com"    ,
  "http://conviva.com"    ,
  "http://tandfonline.com"    ,
  "http://ezvizlife.com"    ,
  "http://rt.ru"    ,
  "http://cookiedatabase.org"    ,
  "http://google.co.jp"    ,
  "http://docker.com"    ,
  "http://hostgator.com"    ,
  "http://atlassian.com"    ,
  "http://aboutads.info"    ,
  "http://nel.goog"    ,
  "http://merriam-webster.com"    ,
  "http://shutterstock.com"    ,
  "http://warnerbros.com"    ,
  "http://myqcloud.com"    ,
  "http://licdn.com"    ,
  "http://cbsnews.com"    ,
  "http://akam.net"    ,
  "http://chinamobile.com"    ,
  "http://accuweather.com"    ,
  "http://telephony.goog"    ,
  "http://bdydns.com"    ,
  "http://easebar.com"    ,
  "http://ikea.com"    ,
  "http://wattpad.com"    ,
  "http://smaato.net"    ,
  "http://yelp.com"    ,
  "http://nike.com"    ,
  "http://qualtrics.com"    ,
  "http://vivoglobal.com"    ,
  "http://trustpilot.com"    ,
  "http://sina.com.cn"    ,
  "http://lijit.com"    ,
  "http://newrelic.com"    ,
  "http://techcrunch.com"    ,
  "http://sapo.pt"    ,
  "http://livejournal.com"    ,
  "http://yieldmo.com"    ,
  "http://svc.ms"    ,
  "http://163.com"    ,
  "http://cookielaw.org"    ,
  "http://usgovcloudapi.net"    ,
  "http://erome.com"    ,
  "http://bitrix24.ru"    ,
  "http://uber.com"    ,
  "http://mozgcp.net"    ,
  "http://creativecdn.com"    ,
  "http://herokudns.com"    ,
  "http://optimizely.com"    ,
  "http://wb.ru"    ,
  "http://free.fr"    ,
  "http://quantserve.com"    ,
  "http://samsungapps.com"    ,
  "http://agkn.com"    ,
  "http://fandom.com"    ,
  "http://stackadapt.com"    ,
  "http://discord.media"    ,
  "http://grammarly.io"    ,
  "http://fontawesome.com"    ,
  "http://coinmarketcap.com"    ,
  "http://ieee.org"    ,
  "http://google.es"    ,
  "http://threads.net"    ,
  "http://byteglb.com"    ,
  "http://live.net"    ,
  "http://360safe.com"    ,
  "http://noaa.gov"    ,
  "http://ovscdns.net"    ,
  "http://latimes.com"    ,
  "http://google.co.in"    ,
  "http://w3schools.com"    ,
  "http://aws.dev"    ,
  "http://sberbank.ru"    ,
  "http://tapad.com"    ,
  "http://fb.com"    ,
  "http://typekit.net"    ,
  "http://xiaomi.net"    ,
  "http://elpais.com"    ,
  "http://dotomi.com"    ,
  "http://theverge.com"    ,
  "http://google.it"    ,
  "http://samsungacr.com"    ,
  "http://cdnvideo.ru"    ,
  "http://crwdcntrl.net"    ,
  "http://myspace.com"    ,
  "http://klaviyo.com"    ,
  "http://browser-intake-datadoghq.com"    ,
  "http://maricopa.gov"    ,
  "http://rackspace.com"    ,
  "http://adobedtm.com"    ,
  "http://service.gov.uk"    ,
  "http://pinimg.com"    ,
  "http://jotform.com"    ,
  "http://lvcampaign.com"    ,
  "http://amazon.ca"    ,
  "http://cdnhwc1.com"    ,
  "http://dynatrace.com"    ,
  "http://att.net"    ,
  "http://cambridge.org"    ,
  "http://webmd.com"    ,
  "http://investopedia.com"    ,
  "http://prnewswire.com"    ,
  "http://intercom.io"    ,
  "http://amazon.fr"    ,
  "http://cdnhwc2.com"    ,
  "http://bidr.io"    ,
  "http://redhat.com"    ,
  "http://brave.com"    ,
  "http://nbcnews.com"    ,
  "http://cqloud.com"    ,
  "http://withgoogle.com"    ,
  "http://footprintdns.com"    ,
  "http://avito.ru"    ,
  "http://bamgrid.com"    ,
  "http://ks-cdn.com"    ,
  "http://dbankcloud.com"    ,
  "http://wswebcdn.com"    ,
  "http://oraclecloud.com"    ,
  "http://xvideos.com"    ,
  "http://appspot.com"    ,
  "http://herokuapp.com"    ,
  "http://pvp.net"    ,
  "http://e-msedge.net"    ,
  "http://worldnic.com"    ,
  "http://google.com.hk"    ,
  "http://delfi.lt"    ,
  "http://apnews.com"    ,
  "http://bestbuy.com"    ,
  "http://homedepot.com"    ,
  "http://33across.com"    ,
  "http://box.com"    ,
  "http://imrworldwide.com"    ,
  "http://1rx.io"    ,
  "http://quickconnect.to"    ,
  "http://hbr.org"    ,
  "http://vidaahub.com"    ,
  "http://washington.edu"    ,
  "http://awsglobalaccelerator.com"    ,
  "http://unesco.org"    ,
  "http://incapdns.net"    ,
  "http://criteo.net"    ,
  "http://mediafire.com"    ,
  "http://zemanta.com"    ,
  "http://sagepub.com"    ,
  "http://anydesk.com"    ,
  "http://tbcache.com"    ,
  "http://msecnd.net"    ,
  "http://healthline.com"    ,
  "http://clever.com"    ,
  "http://coingecko.com"    ,
  "http://adform.net"    ,
  "http://shopee.co.id"    ,
  "http://lemonde.fr"    ,
  "http://gumgum.com"    ,
  "http://yellowblue.io"    ,
  "http://everesttech.net"    ,
  "http://immedia-semi.com"    ,
  "http://airbnb.com"    ,
  "http://linode.com"    ,
  "http://azure-dns.com"    ,
  "http://typeform.com"    ,
  "http://people.com"    ,
  "http://isappcloud.com"    ,
  "http://usda.gov"    ,
  "http://bugsnag.com"    ,
  "http://amazon.in"    ,
  "http://miwifi.com"    ,
  "http://turn.com"    ,
  "http://mongodb.com"    ,
  "http://ya.ru"    ,
  "http://contextweb.com"    ,
  "http://fda.gov"    ,
  "http://mgts.ru"    ,
  "http://pccc.com"    ,
  "http://nikkei.com"    ,
  "http://rspamd.com"    ,
  "http://fiverr.com"    ,
  "http://rbc.ru"    ,
  "http://digitalocean.com"    ,
  "http://cloudflareinsights.com"    ,
  "http://zillow.com"    ,
  "http://allaboutcookies.org"    ,
  "http://vivo.com.cn"    ,
  "http://express.co.uk"    ,
  "http://cox.net"    ,
  "http://mixpanel.com"    ,
  "http://live-video.net"    ,
  "http://pendo.io"    ,
  "http://usps.com"    ,
  "http://2gis.com"    ,
  "http://ioam.de"    ,
  "http://heylink.me"    ,
  "http://bandcamp.com"    ,
  "http://theatlantic.com"    ,
  "http://discordapp.com"    ,
  "http://a-mo.net"    ,
  "http://protek.ru"    ,
  "http://mobile.de"    ,
  "http://name.com"    ,
  "http://shopee.com.br"    ,
  "http://mgid.com"    ,
  "http://attn.tv"    ,
  "http://exp-tas.com"    ,
  "http://themeforest.net"    ,
  "http://alidns.com"    ,
  "http://whitehouse.gov"    ,
  "http://nationalgeographic.com"    ,
  "http://hihonorcloud.com"    ,
  "http://onlyfans.com"    ,
  "http://blueapron.com"    ,
  "http://fidelity.com"    ,
  "http://iso.org"    ,
  "http://networkadvertising.org"    ,
  "http://apigee.net"    ,
  "http://xbox.com"    ,
  "http://change.org"    ,
  "http://perfectdomain.com"    ,
  "http://githubusercontent.com"    ,
  "http://deltaork.com"    ,
  "http://steamstatic.com"    ,
  "http://google.cn"    ,
  "http://tremorhub.com"    ,
  "http://viber.com"    ,
  "http://360.cn"    ,
  "http://princeton.edu"    ,
  "http://upwork.com"    ,
  "http://pbs.org"    ,
  "http://kargo.com"    ,
  "http://comfortel.pro"    ,
  "http://news.com.au"    ,
  "http://istockphoto.com"    ,
  "http://ssl-images-amazon.com"    ,
  "http://omnitagjs.com"    ,
  "http://huffingtonpost.com"    ,
  "http://markmonitor.com"    ,
  "http://adobedc.net"    ,
  "http://dbankcloud.cn"    ,
  "http://substack.com"    ,
  "http://academia.edu"    ,
  "http://recaptcha.net"    ,
  "http://lenovo.com"    ,
  "http://wyzecam.com"    ,
  "http://twilio.com"    ,
  "http://me.com"    ,
  "http://amazon.it"    ,
  "http://teads.tv"    ,
  "http://google.pl"    ,
  "http://unrulymedia.com"    ,
  "http://arxiv.org"    ,
  "http://mailchi.mp"    ,
  "http://primevideo.com"    ,
  "http://contentsquare.net"    ,
  "http://liftoff.io"    ,
  "http://wbbasket.ru"    ,
  "http://badoo.com"    ,
  "http://welt.de"    ,
  "http://go-mpulse.net"    ,
  "http://cloudapp.net"    ,
  "http://lefigaro.fr"    ,
  "http://stickyadstv.com"    ,
  "http://skyhigh.cloud"    ,
  "http://volcfcdndvs.com"    ,
  "http://life360.com"    ,
  "http://hindustantimes.com"    ,
  "http://globalsign.com"    ,
  "http://scdn.co"    ,
  "http://firebaseio.com"    ,
  "http://spamhaus.org"    ,
  "http://worldbank.org"    ,
  "http://ameblo.jp"    ,
  "http://zoho.com"    ,
  "http://bild.de"    ,
  "http://onetag-sys.com"    ,
  "http://allegro.pl"    ,
  "http://unpkg.com"    ,
  "http://va.gov"    ,
  "http://gdemoideti.ru"    ,
  "http://pornhub.com"    ,
  "http://epa.gov"    ,
  "http://bitdefender.com"    ,
  "http://netgear.com"    ,
  "http://mdpi.com"    ,
  "http://state.gov"    ,
  "http://ebay.co.uk"    ,
  "http://genius.com"    ,
  "http://google.com.tr"    ,
  "http://flashtalking.com"    ,
  "http://google.com.mx"    ,
  "http://amazon.es"    ,
  "http://bluehost.com"    ,
  "http://adjust.com"    ,
  "http://mckinsey.com"    ,
  "http://nic.do"    ,
  "http://azure-devices.net"    ,
  "http://kickstarter.com"    ,
  "http://huffpost.com"    ,
  "http://riotgames.com"    ,
  "http://fbsbx.com"    ,
  "http://spotifycdn.com"    ,
  "http://bankofamerica.com"    ,
  "http://discogs.com"    ,
  "http://classlink.com"    ,
  "http://dnsv1.com"    ,
  "http://biblegateway.com"    ,
  "http://adblockplus.org"    ,
  "http://wp.pl"    ,
  "http://otto.de"    ,
  "http://realtor.com"    ,
  "http://ipify.org"    ,
  "http://bytefcdn.com"    ,
  "http://btloader.com"    ,
  "http://fb-t-msedge.net"    ,
  "http://tubi.io"    ,
  "http://smartthings.com"    ,
  "http://irs.gov"    ,
  "http://xerox.com"    ,
  "http://sonobi.com"    ,
  "http://arcgis.com"    ,
  "http://tokopedia.com"    ,
  "http://aiv-delivery.net"    ,
  "http://cloudns.net"    ,
  "http://freepik.com"    ,
  "http://mozilla.net"    ,
  "http://lowes.com"    ,
  "http://chartbeat.net"    ,
  "http://att.com"    ,
  "http://daum.net"    ,
  "http://dribbble.com"    ,
  "http://omni.ru"    ,
  "http://firefox.com"    ,
  "http://chaturbate.com"    ,
  "http://dbankcloud.ru"    ,
  "http://instructure.com"    ,
  "http://cloudsink.net"    ,
  "http://hm.com"    ,
  "http://ad.gt"    ,
  "http://amazon.com.br"    ,
  "http://adgrx.com"    ,
  "http://shopeemobile.com"    ,
  "http://onet.pl"    ,
  "http://synology.com"    ,
  "http://richaudience.com"    ,
  "http://hilton.com"    ,
  "http://kontur.ru"    ,
  "http://rncdn7.com"    ,
  "http://repubblica.it"    ,
  "http://instabug.com"    ,
  "http://ohthree.com"    ,
  "http://samsungosp.com"    ,
  "http://heytapmobi.com"    ,
  "http://weforum.org"    ,
  "http://kohls.com"    ,
  "http://innovid.com"    ,
  "http://tencent.com"    ,
  "http://kaspi.kz"    ,
  "http://atlassian.net"    ,
  "http://utorrent.com"    ,
  "http://tplinkcloud.com"    ,
  "http://character.ai"    ,
  "http://seznam.cz"    ,
  "http://readthedocs.io"    ,
  "http://pexels.com"    ,
  "http://deloitte.com"    ,
  "http://vkuseraudio.net"    ,
  "http://chess.com"    ,
  "http://dyndns.org"    ,
  "http://redd.it"    ,
  "http://curseforge.com"    ,
  "http://service-now.com"    ,
  "http://1drv.com"    ,
  "http://columbia.edu"    ,
  "http://poshvine.com"    ,
  "http://g.co"    ,
  "http://ip-api.com"    ,
  "http://docker.io"    ,
  "http://nintendo.net"    ,
  "http://pikabu.ru"    ,
  "http://openstreetmap.org"    ,
  "http://corriere.it"    ,
  "http://onesignal.com"    ,
  "http://mirtesen.ru"    ,
  "http://youku.com"    ,
  "http://elmundo.es"    ,
  "http://cloudinary.com"    ,
  "http://xing.com"    ,
  "http://ebay.de"    ,
  "http://ancestry.com"    ,
  "http://ryanair.com"    ,
  "http://xnxx.com"    ,
  "http://python.org"    ,
  "http://eporner.com"    ,
  "http://usnews.com"    ,
  "http://nexusmods.com"    ,
  "http://agoda.com"    ,
  "http://pandora.com"    ,
  "http://mercadolivre.com.br"    ,
  "http://figma.com"    ,
  "http://ubnt.com"    ,
  "http://alphonso.tv"    ,
  "http://samsungcloudsolution.net"    ,
  "http://quizlet.com"    ,
  "http://mercadolibre.com.ar"    ,
  "http://betweendigital.com"    ,
  "http://rapid7.com"    ,
  "http://umich.edu"    ,
  "http://caixa.gov.br"    ,
  "http://cbc.ca"    ,
  "http://umeng.com"    ,
  "http://redfin.com"    ,
  "http://statcounter.com"    ,
  "http://theconversation.com"    ,
  "http://bsky.app"    ,
  "http://bytetcdn.com"    ,
  "http://economist.com"    ,
  "http://francetvinfo.fr"    ,
  "http://www.gov.br"    ,
  "http://costco.com"    ,
  "http://geeksforgeeks.org"    ,
  "http://microsoftpersonalcontent.com"    ,
  "http://gandi-ns.fr"    ,
  "http://macys.com"    ,
  "http://yale.edu"    ,
  "http://nelreports.net"    ,
  "http://ubi.com"    ,
  "http://disneyplus.com"    ,
  "http://samsungnyc.com"    ,
  "http://pixiv.net"    ,
  "http://beget.com" ,
  "http://lgtvcommon.com"
]

malicious_urls = [
 "https://aeno.730740.com"  ,
 "https://weizhenyouchuang.com"  ,
 "https://unitedfilmcritics.com"  ,
 "https://mail.haoxuezl.com"  ,
 "https://gp880.com"  ,
 "https://accoun.theparttimeinvestor.com"  ,
 "https://weismkkshimeiwei.shtlgjg.com"  ,
 "https://iunjeaibr.com"  ,
 "https://accoun.atthebeachamerica.com"  ,
 "https://8oegg4l.weizhenyouchuang.com"  ,
 "https://mercarimil.com"  ,
 "https://omycnsnjdg.com"  ,
 "https://_.mexico-rockypoint.com"  ,
 "https://daqinhua.com"  ,
 "https://conditii-incoterms.com"  ,
 "https://omycnsnjdg.com"  ,
 "https://autovermietungizmir.com"  ,
 "https://fleetwoodchicago.com"  ,
 "https://0zpv2kbp58.weizhenyouchuang.com"  ,
 "https://cirg8ratsuethv.weizhenyouchuang.com"  ,
 "https://baihuisc2599.com"  ,
 "https://www.baihuisc2599.com"  ,
 "https://aeornloginof.b2conlineshop.com"  ,
 "https://weismkkshimeiwei.discoklick.com"  ,
 "https://11mwsu13xjgbl.weizhenyouchuang.com"  ,
 "https://www.conditii-incoterms.com"  ,
 "https://6441056b613c32a9.taiwanhotrodproducts.com"  ,
 "https://agerschou.com"  ,
 "https://slabavalanche.com"  ,
 "http://www.kutndr.com"  ,
 "0017.chen03.com"  ,
 "http://002.yahwagsc.pro"  ,
 "http://0023.gilkatho.com"  ,
 "http://0026.creationedu.com"  ,
 "http://003.yahwagsc.pro"  ,
 "http://003games.com"  ,
 "http://0040.ozjvwcf.asso.ci"  ,
 "http://005.yahwagsc.pro"  ,
 "http://008.yahwagsc.pro"  ,
 "http://0091.fojiao.club"  ,
 "http://00b.yahwagsc.pro"  ,
 "http://00j.yahwagsc.pro"  ,
 "http://00o.yahwagsc.pro"  ,
 "http://00r.yahwagsc.pro"  ,
 "http://010.yahwagsc.pro"  ,
 "http://0107.yahwagsc.pro"  ,
 "http://010c.yahwagsc.pro"  ,
 "http://010d.yahwagsc.pro"  ,
 "http://010f.yahwagsc.pro"  ,
 "http://010j.yahwagsc.pro"  ,
 "http://010m.yahwagsc.pro"  ,
 "http://010n.yahwagsc.pro"  ,
 "http://010s.yahwagsc.pro"  ,
 "http://010t.yahwagsc.pro"  ,
 "http://010w.yahwagsc.pro"  ,
 "http://010x.yahwagsc.pro"  ,
 "http://010z.yahwagsc.pro"  ,
 "http://0110.yahwagsc.pro"  ,
 "http://0115.yahwagsc.pro"  ,
 "http://0116.yahwagsc.pro"  ,
 "http://0117.yahwagsc.pro"  ,
 "http://011j.yahwagsc.pro"  ,
 "http://011o.yahwagsc.pro"  ,
 "http://011v.yahwagsc.pro"  ,
 "http://0121.yahwagsc.pro"  ,
 "http://0127.lilghost.club"  ,
 "http://0129.yahwagsc.pro"  ,
 "http://012c.yahwagsc.pro"  ,
 "http://012f.yahwagsc.pro"  ,
 "http://012n.yahwagsc.pro"  ,
 "http://012q.yahwagsc.pro"  ,
 "http://012t.yahwagsc.pro"  ,
 "http://012v.yahwagsc.pro"  ,
 "http://012z.yahwagsc.pro"  ,
 "http://013.yahwagsc.pro"  ,
 "http://0133.yahwagsc.pro"  ,
 "http://0134.yahwagsc.pro"  ,
 "http://0137.yahwagsc.pro"  ,
 "http://013a.yahwagsc.pro"  ,
 "http://013f.yahwagsc.pro"  ,
 "http://013h.yahwagsc.pro"  ,
 "http://013i.yahwagsc.pro"  ,
 "http://013k.yahwagsc.pro"  ,
 "http://013o.yahwagsc.pro"  ,
 "http://013q.yahwagsc.pro"  ,
 "http://013v.yahwagsc.pro"  ,
 "http://0143.yahwagsc.pro"  ,
 "http://0147.yahwagsc.pro"  ,
 "http://014e.yahwagsc.pro"  ,
 "http://014i.yahwagsc.pro"  ,
 "http://014p.yahwagsc.pro"  ,
 "http://014u.yahwagsc.pro"  ,
 "http://0155.yahwagsc.pro"  ,
 "http://0157.yahwagsc.pro"  ,
 "http://015c.yahwagsc.pro"  ,
 "http://015g.yahwagsc.pro"  ,
 "http://015k.yahwagsc.pro"  ,
 "http://015w.yahwagsc.pro"  ,
 "http://0166.yahwagsc.pro"  ,
 "http://0169.yahwagsc.pro"  ,
 "http://016a.yahwagsc.pro"  ,
 "http://016b.yahwagsc.pro"  ,
 "http://016l.yahwagsc.pro"  ,
 "http://016n.yahwagsc.pro"  ,
 "http://016q.yahwagsc.pro"  ,
 "http://016r.yahwagsc.pro"  ,
 "http://017g.yahwagsc.pro"  ,
 "http://017h.yahwagsc.pro"  ,
 "http://017j.yahwagsc.pro"  ,
 "http://017q.yahwagsc.pro"  ,
 "http://017z.yahwagsc.pro"  ,
 "http://0180.yahwagsc.pro"  ,
 "http://0182.yahwagsc.pro"  ,
 "http://0187.yahwagsc.pro"  ,
 "http://0188.yahwagsc.pro"  ,
 "http://018a.yahwagsc.pro"  ,
 "http://018d.yahwagsc.pro"  ,
 "http://018g.yahwagsc.pro"  ,
 "http://018i.yahwagsc.pro"  ,
 "http://018r.yahwagsc.pro"  ,
 "http://018w.yahwagsc.pro"  ,
 "http://019k.yahwagsc.pro"  ,
 "http://019s.yahwagsc.pro"  ,
 "http://019x.yahwagsc.pro"  ,
 "http://01a2.yahwagsc.pro"  ,
 "http://01a5.yahwagsc.pro"  ,
 "http://01a6.yahwagsc.pro"  ,
 "http://01aa.yahwagsc.pro"  ,
 "http://01ai.yahwagsc.pro"  ,
 "http://01al.yahwagsc.pro"  ,
 "http://01am.yahwagsc.pro"  ,
 "http://01an.yahwagsc.pro"  ,
 "http://01ap.yahwagsc.pro"  ,
 "http://01aq.yahwagsc.pro"  ,
 "http://01bf.yahwagsc.pro"  ,
 "http://01bh.yahwagsc.pro"  ,
 "http://01bu.yahwagsc.pro"  ,
 "http://01by.yahwagsc.pro"  ,
 "http://01c.yahwagsc.pro"  ,
 "http://01c2.yahwagsc.pro"  ,
 "http://01c4.yahwagsc.pro"  ,
 "http://01c7.yahwagsc.pro"  ,
 "http://01c8.yahwagsc.pro"  ,
 "http://01c9.yahwagsc.pro"  ,
 "http://01cb.yahwagsc.pro"  ,
 "http://01cd.yahwagsc.pro"  ,
 "http://01ce.yahwagsc.pro"  ,
 "http://01cl.yahwagsc.pro"  ,
 "http://01co.yahwagsc.pro"  ,
 "http://01cp.yahwagsc.pro"  ,
 "http://01ct.yahwagsc.pro"  ,
 "http://01cu.yahwagsc.pro"  ,
 "http://01cy.yahwagsc.pro"  ,
 "http://01cz.yahwagsc.pro"  ,
 "http://01d4.yahwagsc.pro"  ,
 "http://01d6.yahwagsc.pro"  ,
 "http://01da.yahwagsc.pro"  ,
 "http://01dc.yahwagsc.pro"  ,
 "http://01do.yahwagsc.pro"  ,
 "http://01dr.yahwagsc.pro"  ,
 "http://01du.yahwagsc.pro"  ,
 "http://01dv.yahwagsc.pro"  ,
 "http://01dx.yahwagsc.pro"  ,
 "http://01e7.yahwagsc.pro"  ,
 "http://01e9.yahwagsc.pro"  ,
 "http://01ec.yahwagsc.pro"  ,
 "http://01ed.yahwagsc.pro"  ,
 "http://01ef.yahwagsc.pro"  ,
 "http://01ei.yahwagsc.pro" 
]

# URL과 레이블 분리
data = [(url, 0) for url in normal_urls] + [(url, 1) for url in malicious_urls]
df = pd.DataFrame(data, columns=["url", "label"])

# 특징 추출
features = [extract_features(u) for u in df["url"]]
X = pd.DataFrame(features)
y = df["label"]

# 학습용/테스트용 데이터 분리
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# 랜덤 포레스트 모델 생성 및 학습
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# 예측 및 평가
y_pred = model.predict(X_test)
print("정확도:", accuracy_score(y_test, y_pred))
print("분류 보고서:\n", classification_report(y_test, y_pred))

# 새로운 URL 테스트 예시
new_url = "0017.chen03.com"
new_features = pd.DataFrame([extract_features(new_url)])
new_prediction = model.predict(new_features)[0]
print(f"'{new_url}' 예측 결과: {'악성 URL' if new_prediction == 1 else '정상 URL'}")

joblib.dump(model, "ranbdom_forest_model.pkl")
