import joblib
import pandas as pd
import urllib.parse
import re
import time
import whois
from datetime import datetime
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
"""
#도메인 나이 확인
#def check_domain_age(domain):
    try:
        time.sleep(0.3)
        w = whois.whois(domain)
        creation_date = w.creation_date
        if isinstance(creation_date, list):
            creation_date = creation_date[0]
        if creation_date:
            return (datetime.now() - creation_date).days
        else:
            return -1  # creation_date가 None일 경우
    except Exception as e:
        print(f"[WHOIS 오류] 도메인 '{domain}' 조회 실패:", e)
 #       return -1
 """
# URL 특징 추출 함수
def extract_features(url):
    parsed_url = urllib.parse.urlparse(url)
    domain = parsed_url.netloc.replace("www.", "")
    features = {
        'url_length': len(url),
        'num_digits': sum(c.isdigit() for c in url),
        'num_special_chars': len(re.findall(r'[^a-zA-Z0-9]', url)),
        'has_https': 1 if parsed_url.scheme == 'https' else 0,
        'num_subdomains': len(parsed_url.netloc.split('.')) - 2,
        'num_params': len(parsed_url.query.split('&')) if parsed_url.query else 0,
    }
    return features

# 수동 입력된 URL (정상 + 악성)
url_data = [
    ("http://www.naver.com", 0),
    ("https://secure-site.com", 0),
    ("http://phishing-site.ru", 1),
    ("https://bank-login.secure.com", 0),
    ("http://fakebank.com/login", 1),
    ("https://lcjsbhokxy.cc/", 1),
    ("https://liuyiling20.kfgfylgtyy.workers.dev/", 1),
    ("https://felipefloresabogado.cl/wp-content/cache/auth.sso/auth.sso.biglobe.ne.jp/wms.sso.biglobe.ne.jp/", 1),
    ("https://www.huang62.com/smywbc641yr1da9c88", 1),
    ("https://www.kong70.com/smywbc641yr1da9c88", 1),
    ("https://amercianexpre.account-login.kimsingh.net/EswWkqOnv3", 1),
    ("https://www.lx.or.kr", 0),
    ("https://kcscpr.blog.me/", 0),
    ("https://www.facebook.com/lx.or.kr", 0),
    ("https://www.youtube.com/c/libslx", 0),
    ("https://baro.lx.or.kr", 0),
    ("https://lx.or.kr", 0),
    ("https://alio.go.kr", 0),
    ("https://bit.ly/38RFqMN", 0),
    ("http://direct.lx.or.kr", 0),
    ("http://www.moef.go.kr", 0),
    ("https://www.koreaexim.go.kr", 0),
    ("https://www.kpfis.or.kr", 0),
    ("https://www.komsco.com/", 0),
    ("http://www.kic.kr", 0),
    ("http://www.molit.go.kr", 0),
    ("https://www.kcesi.or.kr", 0),
    ("https://www.srail.or.kr", 0),
    ("http://www.korcm.co.kr", 0),
    ("http://www.siqms.or.kr", 0),
    ("https://www.kr.or.kr", 0),
    ("https://www.aviation.or.kr", 0),
    ("https://www.kaia.re.kr", 0),
    ("https://www.kalis.or.kr", 0),
    ("https://sdco.or.kr", 0),
    ("https://www.airport.kr", 0),
    ("https://www.kicte.or.kr", 0),
    ("https://www.jdcenter.com/", 0),
    ("https://www.kohom.or.kr", 0),
    ("http://www.khug.or.kr", 0),
    ("http://www.korailtravel.com/", 0),
    ("https://www.korailnetworks.com/", 0),
    ("http://www.koraillogis.com/", 0),
    ("https://www.korailretail.com/", 0),
    ("https://www.korailtech.kr", 0),
    ("https://www.airport.co.kr", 0),
    ("http://www.kotsa.or.kr", 0),
    ("https://www.ex.co.kr", 0),
    ("https://www.exservice.co.kr", 0),
    ("http://www.reb.or.kr", 0),
    ("https://info.korail.com/", 0),
    ("https://www.lh.or.kr", 0),
    ("http://www.kindkorea.or.kr", 0),
    ("https://www.kiast.or.kr", 0),
    ("https://www.mois.go.kr", 0),
    ("https://www.poba.or.kr", 0),
    ("https://www.kdemo.or.kr", 0),
    ("https://www.fomo.or.kr", 0),
    ("https://www.erc.re.kr", 0),
    ("https://www.gov.kr", 0),
    ("https://www.moe.go.kr", 0),
    ("https://www.gwnudh.or.kr", 0),
    ("https://www.knuh.or.kr", 0),
    ("https://www.knuh.kr", 0),
    ("https://www.knudh.kr:7452/", 0),
    ("http://www.msit.go.kr", 0),
    ("http://www.mofa.go.kr", 0),
    ("https://www.okf.or.kr", 0),
    ("https://www.kf.or.kr", 0),
    ("https://www.koica.go.kr", 0),
    ("https://www.k-af.or.kr", 0),
    ("http://www.unikorea.go.kr", 0),
    ("https://sonosa.or.kr", 0),
    ("http://www.moj.go.kr", 0),
    ("https://www.mrtc.re.kr", 0),
    ("https://www.klac.or.kr", 0),
    ("https://www.kgls.or.kr", 0),
    ("https://www.koreha.or.kr", 0),
    ("http://www.mnd.go.kr", 0),
    ("https://www.add.re.kr", 0),
    ("https://www.dtaq.re.kr", 0),
    ("https://www.moti.or.kr", 0),
    ("http://www.mmaa.or.kr", 0),
    ("http://www.mcst.go.kr", 0),
    ("https://www.kcopa.or.kr", 0),
    ("https://www.grac.or.kr", 0),
    ("https://www.sports.or.kr", 0),
    ("https://www.ngcc.go.kr", 0),
    ("http://www.mafra.go.kr", 0),
    ("https://www.lhca.or.kr", 0),
    ("https://www.ipab.or.kr", 0),
    ("https://www.epis.or.kr", 0),
    ("https://www.ipet.re.kr", 0),
    ("http://www.motie.go.kr", 0),
    ("https://kangwonland.high1.com/", 0),
    ("https://www.kogas-tech.co.kr", 0),
    ("https://www.kocoal.or.kr", 0),
    ("http://www.mohw.go.kr", 0),
    ("https://www.hira.or.kr", 0),
    ("https://ncc.re.kr", 0),
    ("https://www.nmc.or.kr", 0),
    ("https://www.nhis.or.kr", 0),
    ("http://www.me.go.kr", 0),
    ("http://www.moel.go.kr", 0),
    ("https://www.cw.or.kr", 0),
    ("https://www.kcomwel.or.kr", 0),
    ("https://www.nosa.or.kr", 0),
    ("https://www.kopo.ac.kr", 0),
    ("http://www.mogef.go.kr", 0),
    ("https://www.stop.or.kr", 0),
    ("http://www.kihf.or.kr", 0),
    ("https://www.kigepe.or.kr", 0),
    ("https://www.kyci.or.kr", 0),
    ("http://www.mof.go.kr", 0),
    ("https://www.kosm.or.kr", 0),
    ("https://www.knmm.or.kr", 0),
    ("https://www.mabik.re.kr", 0),
    ("https://www.busanpa.com/", 0),
    ("http://www.mss.go.kr", 0),
    ("https://debc.or.kr", 0),
    ("http://www.koef.or.kr", 0),
    ("https://www.sbdc.or.kr", 0),
    ("https://www.kibo.or.kr", 0),
    ("http://www.korea.go.kr", 0),
    ("http://www.mois.go.kr", 0),
    ("http://www.lh.or.kr", 0),
    ("http://www.ex.co.kr", 0),
    ("http://www.krihs.re.kr", 0),
    ("http://www.kdi.re.kr", 0),
    ("https://www.ngii.go.kr", 0),
    ("http://www.fig.net/", 0),
    ("http://www.oicrf.org/", 0),
    ("http://www.isotc211.org/", 0),
    ("http://www.gsi.go.jp/", 0),
    ("http://www.kcia99.or.kr", 0),
    ("http://www.juso.go.kr", 0),
    ("http://hi.nhic.or.kr", 0),
    ("https://www.mpva.go.kr", 0),
    ("http://www.nhic.or.kr", 0),
    ("http://www.nps.or.kr", 0),
    ("http://www.chosashi.or.jp/", 0),
    ("http://www.newjijuk.go.kr", 0),
    ("http://baro.lx.or.kr", 0),
    ("http://www.lxcti.or.kr", 0),
    ("http://lxsiri.re.kr", 0),
    ("https://startup.lx.or.kr", 0),
    ("http://ebid.lx.or.kr", 0),
    ("http://www.lxtu.net/", 0),
    ("http://www.alio.go.kr", 0),
    ("https://jusomap.lx.or.kr", 0),
    ("https://www.khepi.or.kr", 0),
    ("http://www.webwatch.or.kr", 0),
    ("https://ybrjaouww.com/", 1),
("https://aeno.730740.com", 1),
("https://weizhenyouchuang.com", 1),
("https://unitedfilmcritics.com", 1),
("https://mail.haoxuezl.com", 1),
("https://gp880.com", 1),
("https://accoun.theparttimeinvestor.com", 1),
("https://weismkkshimeiwei.shtlgjg.com", 1),
("https://iunjeaibr.com", 1),
("https://accoun.atthebeachamerica.com", 1),
("https://8oegg4l.weizhenyouchuang.com", 1),
("https://mercarimil.com", 1),
("https://omycnsnjdg.com", 1),
("https://_.mexico-rockypoint.com", 1),
("https://daqinhua.com", 1),
("https://conditii-incoterms.com", 1),
("https://omycnsnjdg.com", 1),
("https://autovermietungizmir.com", 1),
("https://fleetwoodchicago.com", 1),
("https://0zpv2kbp58.weizhenyouchuang.com", 1),
("https://cirg8ratsuethv.weizhenyouchuang.com", 1),
("https://baihuisc2599.com", 1),
("https://www.baihuisc2599.com", 1),
("https://aeornloginof.b2conlineshop.com", 1),
("https://weismkkshimeiwei.discoklick.com", 1),
("https://11mwsu13xjgbl.weizhenyouchuang.com", 1),
("https://www.conditii-incoterms.com", 1),
("https://6441056b613c32a9.taiwanhotrodproducts.com", 1),
("https://agerschou.com", 1),
("https://slabavalanche.com", 1),
("http://www.kutndr.com", 1),
("http://google.com", 0),
("http://microsoft.com", 0),
("http://mail.ru", 0),
("http://facebook.com", 0),
("http://dzen.ru", 0),
("http://root-servers.net", 0),
("http://amazonaws.com", 0),
("http://apple.com", 0),
("http://youtube.com", 0),
("http://googleapis.com", 0),
("http://cloudflare.com", 0),
("http://akamai.net", 0),
("http://instagram.com", 0),
("http://twitter.com", 0),
("http://akamaiedge.net", 0),
("http://a-msedge.net", 0),
("http://office.com", 0),
("http://gstatic.com", 0),
("http://azure.com", 0),
("http://linkedin.com", 0),
("http://speedcdns.com", 0),
("http://live.com", 0),
("http://googletagmanager.com", 0),
("http://googlevideo.com", 0),
("http://amazon.com", 0),
("http://fbcdn.net", 0),
("http://akadns.net", 0),
("http://workers.dev", 0),
("http://wikipedia.org", 0),
("http://microsoftonline.com", 0),
("http://tiktokcdn.com", 0),
("http://doubleclick.net", 0),
("http://windowsupdate.com", 0),
("http://googleusercontent.com", 0),
("http://github.com", 0),
("http://l-msedge.net", 0),
("http://t-msedge.net", 0),
("http://trafficmanager.net", 0),
("http://bing.com", 0),
("http://office.net", 0),
("http://apple-dns.net", 0),
("http://dual-s-msedge.net", 0),
("http://wordpress.org", 0),
("http://fastly.net", 0),
("http://pinterest.com", 0),
("http://icloud.com", 0),
("http://whatsapp.net", 0),
("http://youtu.be", 0),
("http://aaplimg.com", 0),
("http://netflix.com", 0),
("http://sharepoint.com", 0),
("http://appsflyersdk.com", 0),
("http://digicert.com", 0),
("http://domaincontrol.com", 0),
("http://yahoo.com", 0),
("http://ax-msedge.net", 0),
("http://skype.com", 0),
("http://googlesyndication.com", 0),
("http://goo.gl", 0),
("http://gtld-servers.net", 0),
("http://whatsapp.com", 0),
("http://cloudfront.net", 0),
("http://adobe.com", 0),
("http://vimeo.com", 0),
("http://windows.net", 0),
("http://spotify.com", 0),
("http://msn.com", 0),
("http://tiktokv.com", 0),
("http://google-analytics.com", 0),
("http://gvt2.com", 0),
("http://bit.ly", 0),
("http://roblox.com", 0),
("http://ntp.org", 0),
("http://bytefcdn-oversea.com", 0),
("http://gvt1.com", 0),
("http://cloudflare.net", 0),
("http://cdn77.org", 0),
("http://intuit.com", 0),
("http://wordpress.com", 0),
("http://tiktok.com", 0),
("http://x.com", 0),
("http://cdn90.cn", 0),
("http://zoom.us", 0),
("http://wac-msedge.net", 0),
("http://yandex.net", 0),
("http://nic.ru", 0),
("http://ytimg.com", 0),
("http://mozilla.org", 0),
("http://gandi.net", 0),
("http://qq.com", 0),
("http://edgekey.net", 0),
("http://office365.com", 0),
("http://e2ro.com", 0),
("http://blogspot.com", 0),
("http://opera.com", 0),
("http://telekom.de", 0),
("http://googledomains.com", 0),
("http://googleadservices.com", 0),
("http://cloudflare-dns.com", 0),
("http://reddit.com", 0),
("http://samsung.com", 0),
("http://cdninstagram.com", 0),
("http://cdn20.com", 0),
("http://msedge.net", 0),
("http://aiv-cdn.net", 0),
("http://unity3d.com", 0),
("http://mts.ru", 0),
("http://flickr.com", 0),
("http://baidu.com", 0),
("http://a2z.com", 0),
("http://snapchat.com", 0),
("http://europa.eu", 0),
("http://telekom.net", 0),
("http://nginx.org", 0),
("http://outlook.com", 0),
("http://tiktokrow-cdn.com", 0),
("http://amazon-adsystem.com", 0),
("http://sentry.io", 0),
("http://apache.org", 0),
("http://vk.com", 0),
("http://t.me", 0),
("http://wa.me", 0),
("http://rbxcdn.com", 0),
("http://adnxs.com", 0),
("http://health.mil", 0),
("http://nginx.com", 0),
("http://rocket-cdn.com", 0),
("http://dropbox.com", 0),
("http://gravatar.com", 0),
("http://app-analytics-services.com", 0),
("http://nist.gov", 0),
("http://windows.com", 0),
("http://github.io", 0),
("http://nih.gov", 0),
("http://criteo.com", 0),
("http://t-online.de", 0),
("http://spo-msedge.net", 0),
("http://pki.goog", 0),
("http://epicgames.com", 0),
("http://app-measurement.com", 0),
("http://msftncsi.com", 0),
("http://edgesuite.net", 0),
("http://tumblr.com", 0),
("http://userapi.com", 0),
("http://okcdn.ru", 0),
("http://dns.google", 0),
("http://trbcdn.net", 0),
("http://macromedia.com", 0),
("http://ui.com", 0),
("http://xiaomi.com", 0),
("http://myfritz.net", 0),
("http://nytimes.com", 0),
("http://applovin.com", 0),
("http://paypal.com", 0),
("http://one.one", 0),
("http://archive.org", 0),
("http://ivi.ru", 0),
("http://lencr.org", 0),
("http://forms.gle", 0),
("http://wsdvs.com", 0),
("http://f5.com", 0),
("http://ggpht.com", 0),
("http://dnsowl.com", 0),
("http://aliyuncs.com", 0),
("http://steamserver.net", 0),
("http://meraki.com", 0),
("http://adriver.ru", 0),
("http://mangosip.ru", 0),
("http://medium.com", 0),
("http://b-msedge.net", 0),
("http://cnn.com", 0),
("http://nflxso.net", 0),
("http://forbes.com", 0),
("http://tiktokcdn-us.com", 0),
("http://whecloud.com", 0),
("http://miit.gov.cn", 0),
("http://soundcloud.com", 0),
("http://t.co", 0),
("http://wildberries.ru", 0),
("http://rubiconproject.com", 0),
("http://cdn-apple.com", 0),
("http://discord.gg", 0),
("http://w3.org", 0),
("http://theguardian.com", 0),
("http://registrar-servers.com", 0),
("http://azurewebsites.net", 0),
("http://casalemedia.com", 0),
("http://yandex.ru", 0),
("http://shifen.com", 0),
("http://amazon.dev", 0),
("http://adobe.io", 0),
("http://kaspersky.com", 0),
("http://s-msedge.net", 0),
("http://amazonvideo.com", 0),
("http://sciencedirect.com", 0),
("http://miui.com", 0),
("http://linkos.bg", 0),
("http://gmail.com", 0),
("http://android.com", 0),
("http://demdex.net", 0),
("http://ebay.com", 0),
("http://akamaihd.net", 0),
("http://akamaized.net", 0),
("http://doubleverify.com", 0),
("http://ozon.ru", 0),
("http://twitch.tv", 0),
("http://bbc.com", 0),
("http://bbc.co.uk", 0),
("http://ttlivecdn.com", 0),
("http://b-cdn.net", 0),
("http://taboola.com", 0),
("http://creativecommons.org", 0),
("http://roku.com", 0),
("http://webex.com", 0),
("http://jomodns.com", 0),
("http://cisco.com", 0),
("http://sourceforge.net", 0),
("http://cedexis.net", 0),
("http://edgecdn.ru", 0),
("http://xn--8win4-xg1h.com", 0),
("http://mit.edu", 0),
("http://omtrdc.net", 0),
("http://msftconnecttest.com", 0),
("http://salesforce.com", 0),
("http://3gppnetwork.org", 0),
("http://ksyuncdn.com", 0),
("http://qlivecdn.com", 0),
("http://scorecardresearch.com", 0),
("http://comcast.net", 0),
("http://example.com", 0),
("http://imdb.com", 0),
("http://vungle.com", 0),
("http://researchgate.net", 0),
("http://ubuntu.com", 0),
("http://shopify.com", 0),
("http://cdngslb.com", 0),
("http://arubanetworks.com", 0),
("http://who.int", 0),
("http://my.com", 0),
("http://canva.com", 0),
("http://nvidia.com", 0),
("http://youtube-nocookie.com", 0),
("http://openai.com", 0),
("http://azurefd.net", 0),
("http://pubmatic.com", 0),
("http://hp.com", 0),
("http://hubspot.com", 0),
("http://doi.org", 0),
("http://discord.com", 0),
("http://slack.com", 0),
("http://linktr.ee", 0),
("http://oracle.com", 0),
("http://avast.com", 0),
("http://wixsite.com", 0),
("http://dell.com", 0),
("http://googleblog.com", 0),
("http://facebook.net", 0),
("http://nr-data.net", 0),
("http://tinyurl.com", 0),
("http://issuu.com", 0),
("http://vedcdnlb.com", 0),
("http://wikimedia.org", 0),
("http://bytefcdn-ttpeu.com", 0),
("http://ttdns2.com", 0),
("http://byteoversea.net", 0),
("http://openx.net", 0),
("http://launchdarkly.com", 0),
("http://mi.com", 0),
("http://2mdn.net", 0),
("http://pv-cdn.net", 0),
("http://ampproject.org", 0),
("http://appsflyer.com", 0),
("http://crashlytics.com", 0),
("http://taobao.com", 0),
("http://stripe.com", 0),
("http://netangels.ru", 0),
("http://cpanel.net", 0),
("http://tradingview.com", 0),
("http://opendns.com", 0),
("http://alibabadns.com", 0),
("http://weebly.com", 0),
("http://mzstatic.com", 0),
("http://cdc.gov", 0),
("http://drom.ru", 0),
("http://mtgglobals.com", 0),
("http://reuters.com", 0),
("http://reg.ru", 0),
("http://chatgpt.com", 0),
("http://harvard.edu", 0),
("http://3lift.com", 0),
("http://php.net", 0),
("http://samsungcloud.com", 0),
("http://ln-msedge.net", 0),
("http://godaddy.com", 0),
("http://google.com.br", 0),
("http://tiktokv.us", 0),
("http://www.gov.uk", 0),
("http://adsrvr.org", 0),
("http://ripn.net", 0),
("http://steampowered.com", 0),
("http://espn.com", 0),
("http://booking.com", 0),
("http://launchpad.net", 0),
("http://dailymail.co.uk", 0),
("http://ibm.com", 0),
("http://amazon.co.uk", 0),
("http://azureedge.net", 0),
("http://washingtonpost.com", 0),
("http://static.microsoft", 0),
("http://samsungqbe.com", 0),
("http://wiley.com", 0),
("http://slideshare.net", 0),
("http://1c.ru", 0),
("http://forter.com", 0),
("http://appcenter.ms", 0),
("http://xcal.tv", 0),
("http://ttvnw.net", 0),
("http://bidswitch.net", 0),
("http://capcutapi.com", 0),
("http://playstation.net", 0),
("http://sharethrough.com", 0),
("http://go.com", 0),
("http://salesforceliveagent.com", 0),
("http://weather.com", 0),
("http://wsj.com", 0),
("http://alicdn.com", 0),
("http://alibaba.com", 0),
("http://t-mobile.com", 0),
("http://ea.com", 0),
("http://inmobi.com", 0),
("http://jsdelivr.net", 0),
("http://spov-msedge.net", 0),
("http://nature.com", 0),
("http://branch.io", 0),
("http://netflix.net", 0),
("http://smartadserver.com", 0),
("http://pages.dev", 0),
("http://nease.net", 0),
("http://outbrain.com", 0),
("http://bloomberg.com", 0),
("http://debian.org", 0),
("http://shalltry.com", 0),
("http://adtrafficquality.google", 0),
("http://etsy.com", 0),
("http://weibo.com", 0),
("http://springer.com", 0),
("http://fastly-edge.com", 0),
("http://dailymotion.com", 0),
("http://adsafeprotected.com", 0),
("http://checkpoint.com", 0),
("http://stackoverflow.com", 0),
("http://un.org", 0),
("http://worldfcdn2.com", 0),
("http://mangatoon.mobi", 0),
("http://allawnos.com", 0),
("http://samsungcloudsolution.com", 0),
("http://gnu.org", 0),
("http://vkuser.net", 0),
("http://mcafee.com", 0),
("http://wp.com", 0),
("http://deepintent.com", 0),
("http://douyincdn.com", 0),
("http://moe.video", 0),
("http://google.de", 0),
("http://gosuslugi.ru", 0),
("http://zendesk.com", 0),
("http://telegraph.co.uk", 0),
("http://nasa.gov", 0),
("http://liadm.com", 0),
("http://rutube.ru", 0),
("http://ring.com", 0),
("http://goskope.com", 0),
("http://huawei.com", 0),
("http://mynetname.net", 0),
("http://businessinsider.com", 0),
("http://clarity.ms", 0),
("http://cloud.microsoft", 0),
("http://stanford.edu", 0),
("http://independent.co.uk", 0),
("http://pixabay.com", 0),
("http://duckdns.org", 0),
("http://list-manage.com", 0),
("http://dnsmadeeasy.com", 0),
("http://sc-cdn.net", 0),
("http://pangle.io", 0),
("http://inner-active.mobi", 0),
("http://yximgs.com", 0),
("http://heytapdl.com", 0),
("http://hichina.com", 0),
("http://kaspersky-labs.com", 0),
("http://unsplash.com", 0),
("http://crpt.ru", 0),
("http://naver.com", 0),
("http://gcdn.co", 0),
("http://cnbc.com", 0),
("http://notamedia.ru", 0),
("http://foxnews.com", 0),
("http://atomile.com", 0),
("http://force.com", 0),
("http://consultant.ru", 0),
("http://wbx2.com", 0),
("http://indeed.com", 0),
("http://autodesk.com", 0),
("http://quora.com", 0),
("http://indexww.com", 0),
("http://online-metrix.net", 0),
("http://aliexpress.com", 0),
("http://sohu.com", 0),
("http://xboxlive.com", 0),
("http://tp-link.com", 0),
("http://ibyteimg.com", 0),
("http://globo.com", 0),
("http://googletagservices.com", 0),
("http://google.co.uk", 0),
("http://eventbrite.com", 0),
("http://statista.com", 0),
("http://bilibili.com", 0),
("http://ok.ru", 0),
("http://heytapmobile.com", 0),
("http://temu.com", 0),
("http://npr.org", 0),
("http://aol.com", 0),
("http://tiktokcdn-eu.com", 0),
("http://intel.com", 0),
("http://rambler.ru", 0),
("http://ngenix.net", 0),
("http://duckduckgo.com", 0),
("http://nstld.com", 0),
("http://goodreads.com", 0),
("http://elasticbeanstalk.com", 0),
("http://eset.com", 0),
("http://amazon.de", 0),
("http://dnspod.net", 0),
("http://telegram.org", 0),
("http://walmart.com", 0),
("http://byteoversea.com", 0),
("http://sfx.ms", 0),
("http://xhamster.com", 0),
("http://imgsmail.ru", 0),
("http://giphy.com", 0),
("http://cmediahub.ru", 0),
("http://yahoo.co.jp", 0),
("http://media-amazon.com", 0),
("http://avcdn.net", 0),
("http://mikrotik.com", 0),
("http://ctdns.cn", 0),
("http://ys7.com", 0),
("http://wired.com", 0),
("http://teamviewer.com", 0),
("http://myshopify.com", 0),
("http://kwai-pro.com", 0),
("http://duolingo.com", 0),
("http://mozilla.com", 0),
("http://vtwenty.com", 0),
("http://gamepass.com", 0),
("http://usatoday.com", 0),
("http://time.com", 0),
("http://g.page", 0),
("http://firetvcaptiveportal.com", 0),
("http://telegram.me", 0),
("http://behance.net", 0),
("http://dns-parking.com", 0),
("http://calendly.com", 0),
("http://addtoany.com", 0),
("http://mega.co.nz", 0),
("http://netease.com", 0),
("http://braze.com", 0),
("http://nflximg.com", 0),
("http://speedtest.net", 0),
("http://id5-sync.com", 0),
("http://grammarly.com", 0),
("http://beian.gov.cn", 0),
("http://scribd.com", 0),
("http://safebrowsing.apple", 0),
("http://sophos.com", 0),
("http://amazonalexa.com", 0),
("http://timeweb.ru", 0),
("http://sc-gw.com", 0),
("http://mayoclinic.org", 0),
("http://wsglb0.com", 0),
("http://mediatek.com", 0),
("http://amzn.to", 0),
("http://hicloud.com", 0),
("http://ft.com", 0),
("http://twimg.com", 0),
("http://indiatimes.com", 0),
("http://nest.com", 0),
("http://imcmdb.net", 0),
("http://kwai.net", 0),
("http://nflxvideo.net", 0),
("http://gitlab.com", 0),
("http://entrust.net", 0),
("http://avsxappcaptiveportal.com", 0),
("http://paloaltonetworks.com", 0),
("http://mysql.com", 0),
("http://wix.com", 0),
("http://blogger.com", 0),
("http://cnet.com", 0),
("http://uol.com.br", 0),
("http://aliyun.com", 0),
("http://awswaf.com", 0),
("http://ietf.org", 0),
("http://okta.com", 0),
("http://surveymonkey.com", 0),
("http://360yield.com", 0),
("http://shein.com", 0),
("http://squarespace.com", 0),
("http://rlcdn.com", 0),
("http://marriott.com", 0),
("http://nypost.com", 0),
("http://ovscdns.com", 0),
("http://deviantart.com", 0),
("http://trendmicro.com", 0),
("http://yandex.com", 0),
("http://adobe.net", 0),
("http://verisign.com", 0),
("http://media.net", 0),
("http://comcast.com", 0),
("http://impervadns.net", 0),
("http://cdnbuild.net", 0),
("http://name-services.com", 0),
("http://tencent-cloud.net", 0),
("http://plesk.com", 0),
("http://disqus.com", 0),
("http://ted.com", 0),
("http://imgur.com", 0),
("http://google.ca", 0),
("http://berkeley.edu", 0),
("http://vkontakte.ru", 0),
("http://steamcommunity.com", 0),
("http://ups.com", 0),
("http://microsoftapp.net", 0),
("http://patreon.com", 0),
("http://virtualearth.net", 0),
("http://sentinelone.net", 0),
("http://spaceweb.pro", 0),
("http://nestlabs.com", 0),
("http://rakuten.co.jp", 0),
("http://ca.gov", 0),
("http://rzone.de", 0),
("http://target.com", 0),
("http://google.fr", 0),
("http://onetrust.com", 0),
("http://hotjar.com", 0),
("http://redislabs.com", 0),
("http://binance.com", 0),
("http://visualstudio.com", 0),
("http://buzzfeed.com", 0),
("http://loc.gov", 0),
("http://mtu.ru", 0),
("http://msidentity.com", 0),
("http://fast.com", 0),
("http://jquery.com", 0),
("http://icloud-content.com", 0),
("http://line.me", 0),
("http://oup.com", 0),
("http://datadoghq.com", 0),
("http://tripadvisor.com", 0),
("http://britannica.com", 0),
("http://rackspace.net", 0),
("http://googlezip.net", 0),
("http://yahoodns.net", 0),
("http://deepl.com", 0),
("http://amazon.co.jp", 0),
("http://cornell.edu", 0),
("http://playstation.com", 0),
("http://myhuaweicloud.com", 0),
("http://mailchimp.com", 0),
("http://ipv4only.arpa", 0),
("http://amazontrust.com", 0),
("http://amplitude.com", 0),
("http://conviva.com", 0),
("http://tandfonline.com", 0),
("http://ezvizlife.com", 0),
("http://rt.ru", 0),
("http://cookiedatabase.org", 0),
("http://google.co.jp", 0),
("http://docker.com", 0),
("http://hostgator.com", 0),
("http://atlassian.com", 0),
("http://aboutads.info", 0),
("http://nel.goog", 0),
("http://merriam-webster.com", 0),
("http://shutterstock.com", 0),
("http://warnerbros.com", 0),
("http://myqcloud.com", 0),
("http://licdn.com", 0),
("http://cbsnews.com", 0),
("http://akam.net", 0),
("http://chinamobile.com", 0),
("http://accuweather.com", 0),
("http://telephony.goog", 0),
("http://bdydns.com", 0),
("http://easebar.com", 0),
("http://ikea.com", 0),
("http://wattpad.com", 0),
("http://smaato.net", 0),
("http://yelp.com", 0),
("http://nike.com", 0),
("http://qualtrics.com", 0),
("http://vivoglobal.com", 0),
("http://trustpilot.com", 0),
("http://sina.com.cn", 0),
("http://lijit.com", 0),
("http://newrelic.com", 0),
("http://techcrunch.com", 0),
("http://sapo.pt", 0),
("http://livejournal.com", 0),
("http://yieldmo.com", 0),
("http://svc.ms", 0),
("http://163.com", 0),
("http://cookielaw.org", 0),
("http://usgovcloudapi.net", 0),
("http://erome.com", 0),
("http://bitrix24.ru", 0),
("http://uber.com", 0),
("http://mozgcp.net", 0),
("http://creativecdn.com", 0),
("http://herokudns.com", 0),
("http://optimizely.com", 0),
("http://wb.ru", 0),
("http://free.fr", 0),
("http://quantserve.com", 0),
("http://samsungapps.com", 0),
("http://agkn.com", 0),
("http://fandom.com", 0),
("http://stackadapt.com", 0),
("http://discord.media", 0),
("http://grammarly.io", 0),
("http://fontawesome.com", 0),
("http://coinmarketcap.com", 0),
("http://ieee.org", 0),
("http://google.es", 0),
("http://threads.net", 0),
("http://byteglb.com", 0),
("http://live.net", 0),
("http://360safe.com", 0),
("http://noaa.gov", 0),
("http://ovscdns.net", 0),
("http://latimes.com", 0),
("http://google.co.in", 0),
("http://w3schools.com", 0),
("http://aws.dev", 0),
("http://sberbank.ru", 0),
("http://tapad.com", 0),
("http://fb.com", 0),
("http://typekit.net", 0),
("http://xiaomi.net", 0),
("http://elpais.com", 0),
("http://dotomi.com", 0),
("http://theverge.com", 0),
("http://google.it", 0),
("http://samsungacr.com", 0),
("http://cdnvideo.ru", 0),
("http://crwdcntrl.net", 0),
("http://myspace.com", 0),
("http://klaviyo.com", 0),
("http://browser-intake-datadoghq.com", 0),
("http://maricopa.gov", 0),
("http://rackspace.com", 0),
("http://adobedtm.com", 0),
("http://service.gov.uk", 0),
("http://pinimg.com", 0),
("http://jotform.com", 0),
("http://lvcampaign.com", 0),
("http://amazon.ca", 0),
("http://cdnhwc1.com", 0),
("http://dynatrace.com", 0),
("http://att.net", 0),
("http://cambridge.org", 0),
("http://webmd.com", 0),
("http://investopedia.com", 0),
("http://prnewswire.com", 0),
("http://intercom.io", 0),
("http://amazon.fr", 0),
("http://cdnhwc2.com", 0),
("http://bidr.io", 0),
("http://redhat.com", 0),
("http://brave.com", 0),
("http://nbcnews.com", 0),
("http://cqloud.com", 0),
("http://withgoogle.com", 0),
("http://footprintdns.com", 0),
("http://avito.ru", 0),
("http://bamgrid.com", 0),
("http://ks-cdn.com", 0),
("http://dbankcloud.com", 0),
("http://wswebcdn.com", 0),
("http://oraclecloud.com", 0),
("http://xvideos.com", 0),
("http://appspot.com", 0),
("http://herokuapp.com", 0),
("http://pvp.net", 0),
("http://e-msedge.net", 0),
("http://worldnic.com", 0),
("http://google.com.hk", 0),
("http://delfi.lt", 0),
("http://apnews.com", 0),
("http://bestbuy.com", 0),
("http://homedepot.com", 0),
("http://33across.com", 0),
("http://box.com", 0),
("http://imrworldwide.com", 0),
("http://1rx.io", 0),
("http://quickconnect.to", 0),
("http://hbr.org", 0),
("http://vidaahub.com", 0),
("http://washington.edu", 0),
("http://awsglobalaccelerator.com", 0),
("http://unesco.org", 0),
("http://incapdns.net", 0),
("http://criteo.net", 0),
("http://mediafire.com", 0),
("http://zemanta.com", 0),
("http://sagepub.com", 0),
("http://anydesk.com", 0),
("http://tbcache.com", 0),
("http://msecnd.net", 0),
("http://healthline.com", 0),
("http://clever.com", 0),
("http://coingecko.com", 0),
("http://adform.net", 0),
("http://shopee.co.id", 0),
("http://lemonde.fr", 0),
("http://gumgum.com", 0),
("http://yellowblue.io", 0),
("http://everesttech.net", 0),
("http://immedia-semi.com", 0),
("http://airbnb.com", 0),
("http://linode.com", 0),
("http://azure-dns.com", 0),
("http://typeform.com", 0),
("http://people.com", 0),
("http://isappcloud.com", 0),
("http://usda.gov", 0),
("http://bugsnag.com", 0),
("http://amazon.in", 0),
("http://miwifi.com", 0),
("http://turn.com", 0),
("http://mongodb.com", 0),
("http://ya.ru", 0),
("http://contextweb.com", 0),
("http://fda.gov", 0),
("http://mgts.ru", 0),
("http://pccc.com", 0),
("http://nikkei.com", 0),
("http://rspamd.com", 0),
("http://fiverr.com", 0),
("http://rbc.ru", 0),
("http://digitalocean.com", 0),
("http://cloudflareinsights.com", 0),
("http://zillow.com", 0),
("http://allaboutcookies.org", 0),
("http://vivo.com.cn", 0),
("http://express.co.uk", 0),
("http://cox.net", 0),
("http://mixpanel.com", 0),
("http://live-video.net", 0),
("http://pendo.io", 0),
("http://usps.com", 0),
("http://2gis.com", 0),
("http://ioam.de", 0),
("http://heylink.me", 0),
("http://bandcamp.com", 0),
("http://theatlantic.com", 0),
("http://discordapp.com", 0),
("http://a-mo.net", 0),
("http://protek.ru", 0),
("http://mobile.de", 0),
("http://name.com", 0),
("http://shopee.com.br", 0),
("http://mgid.com", 0),
("http://attn.tv", 0),
("http://exp-tas.com", 0),
("http://themeforest.net", 0),
("http://alidns.com", 0),
("http://whitehouse.gov", 0),
("http://nationalgeographic.com", 0),
("http://hihonorcloud.com", 0),
("http://onlyfans.com", 0),
("http://blueapron.com", 0),
("http://fidelity.com", 0),
("http://iso.org", 0),
("http://networkadvertising.org", 0),
("http://apigee.net", 0),
("http://xbox.com", 0),
("http://change.org", 0),
("http://perfectdomain.com", 0),
("http://githubusercontent.com", 0),
("http://deltaork.com", 0),
("http://steamstatic.com", 0),
("http://google.cn", 0),
("http://tremorhub.com", 0),
("http://viber.com", 0),
("http://360.cn", 0),
("http://princeton.edu", 0),
("http://upwork.com", 0),
("http://pbs.org", 0),
("http://kargo.com", 0),
("http://comfortel.pro", 0),
("http://news.com.au", 0),
("http://istockphoto.com", 0),
("http://ssl-images-amazon.com", 0),
("http://omnitagjs.com", 0),
("http://huffingtonpost.com", 0),
("http://markmonitor.com", 0),
("http://adobedc.net", 0),
("http://dbankcloud.cn", 0),
("http://substack.com", 0),
("http://academia.edu", 0),
("http://recaptcha.net", 0),
("http://lenovo.com", 0),
("http://wyzecam.com", 0),
("http://twilio.com", 0),
("http://me.com", 0),
("http://amazon.it", 0),
("http://teads.tv", 0),
("http://google.pl", 0),
("http://unrulymedia.com", 0),
("http://arxiv.org", 0),
("http://mailchi.mp", 0),
("http://primevideo.com", 0),
("http://contentsquare.net", 0),
("http://liftoff.io", 0),
("http://wbbasket.ru", 0),
("http://badoo.com", 0),
("http://welt.de", 0),
("http://go-mpulse.net", 0),
("http://cloudapp.net", 0),
("http://lefigaro.fr", 0),
("http://stickyadstv.com", 0),
("http://skyhigh.cloud", 0),
("http://volcfcdndvs.com", 0),
("http://life360.com", 0),
("http://hindustantimes.com", 0),
("http://globalsign.com", 0),
("http://scdn.co", 0),
("http://firebaseio.com", 0),
("http://spamhaus.org", 0),
("http://worldbank.org", 0),
("http://ameblo.jp", 0),
("http://zoho.com", 0),
("http://bild.de", 0),
("http://onetag-sys.com", 0),
("http://allegro.pl", 0),
("http://unpkg.com", 0),
("http://va.gov", 0),
("http://gdemoideti.ru", 0),
("http://pornhub.com", 0),
("http://epa.gov", 0),
("http://bitdefender.com", 0),
("http://netgear.com", 0),
("http://mdpi.com", 0),
("http://state.gov", 0),
("http://ebay.co.uk", 0),
("http://genius.com", 0),
("http://google.com.tr", 0),
("http://flashtalking.com", 0),
("http://google.com.mx", 0),
("http://amazon.es", 0),
("http://bluehost.com", 0),
("http://adjust.com", 0),
("http://mckinsey.com", 0),
("http://nic.do", 0),
("http://azure-devices.net", 0),
("http://kickstarter.com", 0),
("http://huffpost.com", 0),
("http://riotgames.com", 0),
("http://fbsbx.com", 0),
("http://spotifycdn.com", 0),
("http://bankofamerica.com", 0),
("http://discogs.com", 0),
("http://classlink.com", 0),
("http://dnsv1.com", 0),
("http://biblegateway.com", 0),
("http://adblockplus.org", 0),
("http://wp.pl", 0),
("http://otto.de", 0),
("http://realtor.com", 0),
("http://ipify.org", 0),
("http://bytefcdn.com", 0),
("http://btloader.com", 0),
("http://fb-t-msedge.net", 0),
("http://tubi.io", 0),
("http://smartthings.com", 0),
("http://irs.gov", 0),
("http://xerox.com", 0),
("http://sonobi.com", 0),
("http://arcgis.com", 0),
("http://tokopedia.com", 0),
("http://aiv-delivery.net", 0),
("http://cloudns.net", 0),
("http://freepik.com", 0),
("http://mozilla.net", 0),
("http://lowes.com", 0),
("http://chartbeat.net", 0),
("http://att.com", 0),
("http://daum.net", 0),
("http://dribbble.com", 0),
("http://omni.ru", 0),
("http://firefox.com", 0),
("http://chaturbate.com", 0),
("http://dbankcloud.ru", 0),
("http://instructure.com", 0),
("http://cloudsink.net", 0),
("http://hm.com", 0),
("http://ad.gt", 0),
("http://amazon.com.br", 0),
("http://adgrx.com", 0),
("http://shopeemobile.com", 0),
("http://onet.pl", 0),
("http://synology.com", 0),
("http://richaudience.com", 0),
("http://hilton.com", 0),
("http://kontur.ru", 0),
("http://rncdn7.com", 0),
("http://repubblica.it", 0),
("http://instabug.com", 0),
("http://ohthree.com", 0),
("http://samsungosp.com", 0),
("http://heytapmobi.com", 0),
("http://weforum.org", 0),
("http://kohls.com", 0),
("http://innovid.com", 0),
("http://tencent.com", 0),
("http://kaspi.kz", 0),
("http://atlassian.net", 0),
("http://utorrent.com", 0),
("http://tplinkcloud.com", 0),
("http://character.ai", 0),
("http://seznam.cz", 0),
("http://readthedocs.io", 0),
("http://pexels.com", 0),
("http://deloitte.com", 0),
("http://vkuseraudio.net", 0),
("http://chess.com", 0),
("http://dyndns.org", 0),
("http://redd.it", 0),
("http://curseforge.com", 0),
("http://service-now.com", 0),
("http://1drv.com", 0),
("http://columbia.edu", 0),
("http://poshvine.com", 0),
("http://g.co", 0),
("http://ip-api.com", 0),
("http://docker.io", 0),
("http://nintendo.net", 0),
("http://pikabu.ru", 0),
("http://openstreetmap.org", 0),
("http://corriere.it", 0),
("http://onesignal.com", 0),
("http://mirtesen.ru", 0),
("http://youku.com", 0),
("http://elmundo.es", 0),
("http://cloudinary.com", 0),
("http://xing.com", 0),
("http://ebay.de", 0),
("http://ancestry.com", 0),
("http://ryanair.com", 0),
("http://xnxx.com", 0),
("http://python.org", 0),
("http://eporner.com", 0),
("http://usnews.com", 0),
("http://nexusmods.com", 0),
("http://agoda.com", 0),
("http://pandora.com", 0),
("http://mercadolivre.com.br", 0),
("http://figma.com", 0),
("http://ubnt.com", 0),
("http://alphonso.tv", 0),
("http://samsungcloudsolution.net", 0),
("http://quizlet.com", 0),
("http://mercadolibre.com.ar", 0),
("http://betweendigital.com", 0),
("http://rapid7.com", 0),
("http://umich.edu", 0),
("http://caixa.gov.br", 0),
("http://cbc.ca", 0),
("http://umeng.com", 0),
("http://redfin.com", 0),
("http://statcounter.com", 0),
("http://theconversation.com", 0),
("http://bsky.app", 0),
("http://bytetcdn.com", 0),
("http://economist.com", 0),
("http://francetvinfo.fr", 0),
("http://www.gov.br", 0),
("http://costco.com", 0),
("http://geeksforgeeks.org", 0),
("http://microsoftpersonalcontent.com", 0),
("http://gandi-ns.fr", 0),
("http://macys.com", 0),
("http://yale.edu", 0),
("http://nelreports.net", 0),
("http://ubi.com", 0),
("http://disneyplus.com", 0),
("http://samsungnyc.com", 0),
("http://pixiv.net", 0),
("http://beget.com", 0),
("http://lgtvcommon.com", 0)
]

# URL과 레이블 분리
urls = [item[0] for item in url_data]
labels = [item[1] for item in url_data]

# 특징 추출
features = [extract_features(url) for url in urls]
X = pd.DataFrame(features)
y = pd.Series(labels)

# 학습용/테스트용 데이터 분리
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# 랜덤 포레스트 모델 생성 및 학습
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# 예측 및 평가
y_pred = model.predict(X_test)
print("정확도:", accuracy_score(y_test, y_pred))
print("분류 보고서:\n", classification_report(y_test, y_pred))

# 새로운 URL 테스트 예시
new_url = "https://dyxdjxx.com/"
new_features = pd.DataFrame([extract_features(new_url)])
new_prediction = model.predict(new_features)[0]
print(f"'{new_url}' 예측 결과: {'악성 URL' if new_prediction == 1 else '정상 URL'}")

joblib.dump(model, "ranbdom_forest_model.pkl")